<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <UsingTask AssemblyFile="$(ContractsGeneratorTasksAssembly)" TaskName="LeanCode.ContractsGenerator.Tasks.GenerateContracts" />

  <Target Name="GenerateContracts" BeforeTargets="BeforeBuild" Condition="'@(Contracts)' != ''">

    <GenerateContracts Contracts="@(Contracts)" OutputDir="$(IntermediateOutputPath)">
      <Output TaskParameter="CompiledContracts" ItemName="CompiledContracts" />
    </GenerateContracts>

    <ItemGroup>
      <EmbeddedResource Include="@(CompiledContracts)">
        <LogicalName>%(Filename)%(Extension)</LogicalName>
      </EmbeddedResource>
    </ItemGroup>

  </Target>

  <PropertyGroup>
    <CoreCompileDependsOn>GenerateContracts;$(CoreCompileDependsOn)</CoreCompileDependsOn>
  </PropertyGroup>

</Project>
